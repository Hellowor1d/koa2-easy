#!/usr/bin/env node

const fs = require('fs-extra')
const path = require('path')
const prompt = require('prompt')

const template = path.join(__dirname, '..', 'template')

const schema = {
  properties: {
    dirname: {
      description: 'Input project directory name',
      required: true,
      default: 'koa2-easy'
    }
  }
}

prompt.start()

prompt.get(schema, (err, result) => {
  if (err) throw err
  generateTemplate(result.dirname)
})

function generateTemplate(dirname) {
  try {
    const project = `${process.cwd()}/${dirname}`
    fs.copySync(template, dirname)
    console.log(`Generate koa2-easy at ${process.cwd()}/${dirname}`)
    console.log(`cd ${dirname} && npm install`)
    console.log('use npm run dev to start it')
  } catch (e) {
    console.error(e)
  }
}
